<!DOCTYPE html>
<html>
<head>
  <title>Image Picker</title>
  <script src="https://thunkable.github.io/webviewer-extension/thunkableWebviewerExtension.js" type="text/javascript"></script>
</head>
<body>
  <input type="file" id="file-upload" accept="image/*" style="display: none;">

  <script>
    const fileInput = document.getElementById('file-upload');

    // Handle image selection
    fileInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      const reader = new FileReader();

      reader.onload = function(e) {
        // Send the base64 data to Thunkable
        ThunkableWebviewerExtension.postMessage(e.target.result);
      }

      if (file) {
        reader.readAsDataURL(file);
      }
    });

    // Listen for a message from Thunkable to trigger the file input
    ThunkableWebviewerExtension.receiveMessage(function(message) {
      if (message === "buttonPressed") {
        fileInput.click(); // Programmatically click the hidden input
      }
    });
  </script>
</body>
</html>
